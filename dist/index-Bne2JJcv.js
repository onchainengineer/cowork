import{w as he,u as z,c as fe,g as re,a as me,p as Z,T as ve,d as Y,x as W,b as q,s as w,z as O,j,k as ye,h as Ce,U as $,n as ie,q as Te}from"./index-DcBAKXZ_.js";import{o as r,n as b,s as d,_ as R,r as _e,e as F,a as _,b as ue,u as be}from"./main-C7IUlwtB.js";import"./__vite-browser-external-2447137e-qv044l9q.js";var Se="2.0.44",xe=w(()=>O(r({error:r({code:b().nullable(),message:d(),status:d()})}))),V=Te({errorSchema:xe,errorToMessage:e=>e.error.message}),Ie=w(()=>O(r({outputDimensionality:b().optional(),taskType:R(["SEMANTIC_SIMILARITY","CLASSIFICATION","CLUSTERING","RETRIEVAL_DOCUMENT","RETRIEVAL_QUERY","QUESTION_ANSWERING","FACT_VERIFICATION","CODE_RETRIEVAL_QUERY"]).optional()}))),Ee=class{constructor(e,l){this.specificationVersion="v2",this.maxEmbeddingsPerCall=2048,this.supportsParallelCalls=!0,this.modelId=e,this.config=l}get provider(){return this.config.provider}async doEmbed({values:e,headers:l,abortSignal:c,providerOptions:p}){const a=await Z({provider:"google",providerOptions:p,schema:Ie});if(e.length>this.maxEmbeddingsPerCall)throw new ve({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const v=Y(await W(this.config.headers),l);if(e.length===1){const{responseHeaders:o,value:s,rawValue:u}=await q({url:`${this.config.baseURL}/models/${this.modelId}:embedContent`,headers:v,body:{model:`models/${this.modelId}`,content:{parts:[{text:e[0]}]},outputDimensionality:a?.outputDimensionality,taskType:a?.taskType},failedResponseHandler:V,successfulResponseHandler:j(we),abortSignal:c,fetch:this.config.fetch});return{embeddings:[s.embedding.values],usage:void 0,response:{headers:o,body:u}}}const{responseHeaders:m,value:h,rawValue:i}=await q({url:`${this.config.baseURL}/models/${this.modelId}:batchEmbedContents`,headers:v,body:{requests:e.map(o=>({model:`models/${this.modelId}`,content:{role:"user",parts:[{text:o}]},outputDimensionality:a?.outputDimensionality,taskType:a?.taskType}))},failedResponseHandler:V,successfulResponseHandler:j(Re),abortSignal:c,fetch:this.config.fetch});return{embeddings:h.embeddings.map(o=>o.values),usage:void 0,response:{headers:m,body:i}}}},Re=w(()=>O(r({embeddings:_(r({values:_(b())}))}))),we=w(()=>O(r({embedding:r({values:_(b())})})));function A(e){if(e==null||Oe(e))return;if(typeof e=="boolean")return{type:"boolean",properties:{}};const{type:l,description:c,required:p,properties:a,items:v,allOf:m,anyOf:h,oneOf:i,format:o,const:s,minLength:u,enum:g}=e,t={};if(c&&(t.description=c),p&&(t.required=p),o&&(t.format=o),s!==void 0&&(t.enum=[s]),l)if(Array.isArray(l)){const y=l.includes("null"),n=l.filter(S=>S!=="null");n.length===0?t.type="null":(t.anyOf=n.map(S=>({type:S})),y&&(t.nullable=!0))}else t.type=l;if(g!==void 0&&(t.enum=g),a!=null&&(t.properties=Object.entries(a).reduce((y,[n,S])=>(y[n]=A(S),y),{})),v&&(t.items=Array.isArray(v)?v.map(A):A(v)),m&&(t.allOf=m.map(A)),h)if(h.some(y=>typeof y=="object"&&y?.type==="null")){const y=h.filter(n=>!(typeof n=="object"&&n?.type==="null"));if(y.length===1){const n=A(y[0]);typeof n=="object"&&(t.nullable=!0,Object.assign(t,n))}else t.anyOf=y.map(A),t.nullable=!0}else t.anyOf=h.map(A);return i&&(t.oneOf=i.map(A)),u!==void 0&&(t.minLength=u),t}function Oe(e){return e!=null&&typeof e=="object"&&e.type==="object"&&(e.properties==null||Object.keys(e.properties).length===0)&&!e.additionalProperties}function Me(e,l){var c;const p=[],a=[];let v=!0;const m=(c=l?.isGemmaModel)!=null?c:!1;for(const{role:h,content:i}of e)switch(h){case"system":{if(!v)throw new $({functionality:"system messages are only supported at the beginning of the conversation"});p.push({text:i});break}case"user":{v=!1;const o=[];for(const s of i)switch(s.type){case"text":{o.push({text:s.text});break}case"file":{const u=s.mediaType==="image/*"?"image/jpeg":s.mediaType;o.push(s.data instanceof URL?{fileData:{mimeType:u,fileUri:s.data.toString()}}:{inlineData:{mimeType:u,data:ie(s.data)}});break}}a.push({role:"user",parts:o});break}case"assistant":{v=!1,a.push({role:"model",parts:i.map(o=>{var s,u,g;const t=((u=(s=o.providerOptions)==null?void 0:s.google)==null?void 0:u.thoughtSignature)!=null?String((g=o.providerOptions.google)==null?void 0:g.thoughtSignature):void 0;switch(o.type){case"text":return o.text.length===0?void 0:{text:o.text,thoughtSignature:t};case"reasoning":return o.text.length===0?void 0:{text:o.text,thought:!0,thoughtSignature:t};case"file":{if(o.mediaType!=="image/png")throw new $({functionality:"Only PNG images are supported in assistant messages"});if(o.data instanceof URL)throw new $({functionality:"File data URLs in assistant messages are not supported"});return{inlineData:{mimeType:o.mediaType,data:ie(o.data)}}}case"tool-call":return{functionCall:{name:o.toolName,args:o.input},thoughtSignature:t}}}).filter(o=>o!==void 0)});break}case"tool":{v=!1;const o=[];for(const s of i){const u=s.output;if(u.type==="content")for(const g of u.value)switch(g.type){case"text":o.push({functionResponse:{name:s.toolName,response:{name:s.toolName,content:g.text}}});break;case"media":o.push({inlineData:{mimeType:g.mediaType,data:g.data}},{text:"Tool executed successfully and returned this image as a response"});break;default:o.push({text:JSON.stringify(g)});break}else o.push({functionResponse:{name:s.toolName,response:{name:s.toolName,content:u.value}}})}a.push({role:"user",parts:o});break}}if(m&&p.length>0&&a.length>0&&a[0].role==="user"){const h=p.map(i=>i.text).join(`

`);a[0].parts.unshift({text:h+`

`})}return{systemInstruction:p.length>0&&!m?{parts:p}:void 0,contents:a}}function ae(e){return e.includes("/")?e:`models/${e}`}var ke=w(()=>O(r({responseModalities:_(R(["TEXT","IMAGE"])).optional(),thinkingConfig:r({thinkingBudget:b().optional(),includeThoughts:F().optional(),thinkingLevel:R(["low","medium","high"]).optional()}).optional(),cachedContent:d().optional(),structuredOutputs:F().optional(),safetySettings:_(r({category:R(["HARM_CATEGORY_UNSPECIFIED","HARM_CATEGORY_HATE_SPEECH","HARM_CATEGORY_DANGEROUS_CONTENT","HARM_CATEGORY_HARASSMENT","HARM_CATEGORY_SEXUALLY_EXPLICIT","HARM_CATEGORY_CIVIC_INTEGRITY"]),threshold:R(["HARM_BLOCK_THRESHOLD_UNSPECIFIED","BLOCK_LOW_AND_ABOVE","BLOCK_MEDIUM_AND_ABOVE","BLOCK_ONLY_HIGH","BLOCK_NONE","OFF"])})).optional(),threshold:R(["HARM_BLOCK_THRESHOLD_UNSPECIFIED","BLOCK_LOW_AND_ABOVE","BLOCK_MEDIUM_AND_ABOVE","BLOCK_ONLY_HIGH","BLOCK_NONE","OFF"]).optional(),audioTimestamp:F().optional(),labels:_e(d(),d()).optional(),mediaResolution:R(["MEDIA_RESOLUTION_UNSPECIFIED","MEDIA_RESOLUTION_LOW","MEDIA_RESOLUTION_MEDIUM","MEDIA_RESOLUTION_HIGH"]).optional(),imageConfig:r({aspectRatio:R(["1:1","2:3","3:2","3:4","4:3","4:5","5:4","9:16","16:9","21:9"]).optional(),imageSize:R(["1K","2K","4K"]).optional()}).optional()})));function Ae({tools:e,toolChoice:l,modelId:c}){var p;e=e?.length?e:void 0;const a=[],v=["gemini-flash-latest","gemini-flash-lite-latest","gemini-pro-latest"].some(t=>t===c),m=c.includes("gemini-2")||c.includes("gemini-3")||v,h=c.includes("gemini-1.5-flash")&&!c.includes("-8b"),i=c.includes("gemini-2.5");if(e==null)return{tools:void 0,toolConfig:void 0,toolWarnings:a};const o=e.some(t=>t.type==="function"),s=e.some(t=>t.type==="provider-defined");if(o&&s){const t=e.filter(y=>y.type==="function");a.push({type:"unsupported-tool",tool:e.find(y=>y.type==="function"),details:`Cannot mix function tools with provider-defined tools in the same request. Falling back to provider-defined tools only. The following function tools will be ignored: ${t.map(y=>y.name).join(", ")}. Please use either function tools or provider-defined tools, but not both.`})}if(s){const t=[];return e.filter(n=>n.type==="provider-defined").forEach(n=>{switch(n.id){case"google.google_search":m?t.push({googleSearch:{}}):h?t.push({googleSearchRetrieval:{dynamicRetrievalConfig:{mode:n.args.mode,dynamicThreshold:n.args.dynamicThreshold}}}):t.push({googleSearchRetrieval:{}});break;case"google.url_context":m?t.push({urlContext:{}}):a.push({type:"unsupported-tool",tool:n,details:"The URL context tool is not supported with other Gemini models than Gemini 2."});break;case"google.code_execution":m?t.push({codeExecution:{}}):a.push({type:"unsupported-tool",tool:n,details:"The code execution tools is not supported with other Gemini models than Gemini 2."});break;case"google.file_search":i?t.push({fileSearch:{...n.args}}):a.push({type:"unsupported-tool",tool:n,details:"The file search tool is only supported with Gemini 2.5 models."});break;case"google.vertex_rag_store":m?t.push({retrieval:{vertex_rag_store:{rag_resources:{rag_corpus:n.args.ragCorpus},similarity_top_k:n.args.topK}}}):a.push({type:"unsupported-tool",tool:n,details:"The RAG store tool is not supported with other Gemini models than Gemini 2."});break;default:a.push({type:"unsupported-tool",tool:n});break}}),{tools:t.length>0?t:void 0,toolConfig:void 0,toolWarnings:a}}const u=[];for(const t of e)switch(t.type){case"function":u.push({name:t.name,description:(p=t.description)!=null?p:"",parameters:A(t.inputSchema)});break;default:a.push({type:"unsupported-tool",tool:t});break}if(l==null)return{tools:[{functionDeclarations:u}],toolConfig:void 0,toolWarnings:a};const g=l.type;switch(g){case"auto":return{tools:[{functionDeclarations:u}],toolConfig:{functionCallingConfig:{mode:"AUTO"}},toolWarnings:a};case"none":return{tools:[{functionDeclarations:u}],toolConfig:{functionCallingConfig:{mode:"NONE"}},toolWarnings:a};case"required":return{tools:[{functionDeclarations:u}],toolConfig:{functionCallingConfig:{mode:"ANY"}},toolWarnings:a};case"tool":return{tools:[{functionDeclarations:u}],toolConfig:{functionCallingConfig:{mode:"ANY",allowedFunctionNames:[l.toolName]}},toolWarnings:a};default:{const t=g;throw new $({functionality:`tool choice type: ${t}`})}}}function se({finishReason:e,hasToolCalls:l}){switch(e){case"STOP":return l?"tool-calls":"stop";case"MAX_TOKENS":return"length";case"IMAGE_SAFETY":case"RECITATION":case"SAFETY":case"BLOCKLIST":case"PROHIBITED_CONTENT":case"SPII":return"content-filter";case"FINISH_REASON_UNSPECIFIED":case"OTHER":return"other";case"MALFORMED_FUNCTION_CALL":return"error";default:return"unknown"}}var Ne=class{constructor(e,l){this.specificationVersion="v2";var c;this.modelId=e,this.config=l,this.generateId=(c=l.generateId)!=null?c:re}get provider(){return this.config.provider}get supportedUrls(){var e,l,c;return(c=(l=(e=this.config).supportedUrls)==null?void 0:l.call(e))!=null?c:{}}async getArgs({prompt:e,maxOutputTokens:l,temperature:c,topP:p,topK:a,frequencyPenalty:v,presencePenalty:m,stopSequences:h,responseFormat:i,seed:o,tools:s,toolChoice:u,providerOptions:g}){var t;const y=[],n=await Z({provider:"google",providerOptions:g,schema:ke});s?.some(E=>E.type==="provider-defined"&&E.id==="google.vertex_rag_store")&&!this.config.provider.startsWith("google.vertex.")&&y.push({type:"other",message:`The 'vertex_rag_store' tool is only supported with the Google Vertex provider and might not be supported or could behave unexpectedly with the current Google provider (${this.config.provider}).`});const S=this.modelId.toLowerCase().startsWith("gemma-"),{contents:x,systemInstruction:T}=Me(e,{isGemmaModel:S}),{tools:M,toolConfig:G,toolWarnings:k}=Ae({tools:s,toolChoice:u,modelId:this.modelId});return{args:{generationConfig:{maxOutputTokens:l,temperature:c,topK:a,topP:p,frequencyPenalty:v,presencePenalty:m,stopSequences:h,seed:o,responseMimeType:i?.type==="json"?"application/json":void 0,responseSchema:i?.type==="json"&&i.schema!=null&&((t=n?.structuredOutputs)==null||t)?A(i.schema):void 0,...n?.audioTimestamp&&{audioTimestamp:n.audioTimestamp},responseModalities:n?.responseModalities,thinkingConfig:n?.thinkingConfig,...n?.imageConfig&&{imageConfig:n.imageConfig},...n?.mediaResolution&&{mediaResolution:n.mediaResolution}},contents:x,systemInstruction:S?void 0:T,safetySettings:n?.safetySettings,tools:M,toolConfig:G,cachedContent:n?.cachedContent,labels:n?.labels},warnings:[...y,...k]}}async doGenerate(e){var l,c,p,a,v,m,h,i,o,s,u,g,t;const{args:y,warnings:n}=await this.getArgs(e),S=JSON.stringify(y),x=Y(await W(this.config.headers),e.headers),{responseHeaders:T,value:M,rawValue:G}=await q({url:`${this.config.baseURL}/${ae(this.modelId)}:generateContent`,headers:x,body:y,failedResponseHandler:V,successfulResponseHandler:j(Ge),abortSignal:e.abortSignal,fetch:this.config.fetch}),k=M.candidates[0],E=[],B=(c=(l=k.content)==null?void 0:l.parts)!=null?c:[],I=M.usageMetadata;let L;for(const C of B)if("executableCode"in C&&((p=C.executableCode)!=null&&p.code)){const U=this.config.generateId();L=U,E.push({type:"tool-call",toolCallId:U,toolName:"code_execution",input:JSON.stringify(C.executableCode),providerExecuted:!0})}else"codeExecutionResult"in C&&C.codeExecutionResult?(E.push({type:"tool-result",toolCallId:L,toolName:"code_execution",result:{outcome:C.codeExecutionResult.outcome,output:C.codeExecutionResult.output},providerExecuted:!0}),L=void 0):"text"in C&&C.text!=null&&C.text.length>0?E.push({type:C.thought===!0?"reasoning":"text",text:C.text,providerMetadata:C.thoughtSignature?{google:{thoughtSignature:C.thoughtSignature}}:void 0}):"functionCall"in C?E.push({type:"tool-call",toolCallId:this.config.generateId(),toolName:C.functionCall.name,input:JSON.stringify(C.functionCall.args),providerMetadata:C.thoughtSignature?{google:{thoughtSignature:C.thoughtSignature}}:void 0}):"inlineData"in C&&E.push({type:"file",data:C.inlineData.data,mediaType:C.inlineData.mimeType});const K=(a=le({groundingMetadata:k.groundingMetadata,generateId:this.config.generateId}))!=null?a:[];for(const C of K)E.push(C);return{content:E,finishReason:se({finishReason:k.finishReason,hasToolCalls:E.some(C=>C.type==="tool-call")}),usage:{inputTokens:(v=I?.promptTokenCount)!=null?v:void 0,outputTokens:(m=I?.candidatesTokenCount)!=null?m:void 0,totalTokens:(h=I?.totalTokenCount)!=null?h:void 0,reasoningTokens:(i=I?.thoughtsTokenCount)!=null?i:void 0,cachedInputTokens:(o=I?.cachedContentTokenCount)!=null?o:void 0},warnings:n,providerMetadata:{google:{promptFeedback:(s=M.promptFeedback)!=null?s:null,groundingMetadata:(u=k.groundingMetadata)!=null?u:null,urlContextMetadata:(g=k.urlContextMetadata)!=null?g:null,safetyRatings:(t=k.safetyRatings)!=null?t:null,usageMetadata:I??null}},request:{body:S},response:{headers:T,body:G}}}async doStream(e){const{args:l,warnings:c}=await this.getArgs(e),p=JSON.stringify(l),a=Y(await W(this.config.headers),e.headers),{responseHeaders:v,value:m}=await q({url:`${this.config.baseURL}/${ae(this.modelId)}:streamGenerateContent?alt=sse`,headers:a,body:l,failedResponseHandler:V,successfulResponseHandler:ye(Le),abortSignal:e.abortSignal,fetch:this.config.fetch});let h="unknown";const i={inputTokens:void 0,outputTokens:void 0,totalTokens:void 0};let o;const s=this.config.generateId;let u=!1,g=null,t=null,y=0;const n=new Set;let S;return{stream:m.pipeThrough(new TransformStream({start(x){x.enqueue({type:"stream-start",warnings:c})},transform(x,T){var M,G,k,E,B,I,L,K,C,U,ee,te;if(e.includeRawChunks&&T.enqueue({type:"raw",rawValue:x.rawValue}),!x.success){T.enqueue({type:"error",error:x.error});return}const Q=x.value,N=Q.usageMetadata;N!=null&&(i.inputTokens=(M=N.promptTokenCount)!=null?M:void 0,i.outputTokens=(G=N.candidatesTokenCount)!=null?G:void 0,i.totalTokens=(k=N.totalTokenCount)!=null?k:void 0,i.reasoningTokens=(E=N.thoughtsTokenCount)!=null?E:void 0,i.cachedInputTokens=(B=N.cachedContentTokenCount)!=null?B:void 0);const D=(I=Q.candidates)==null?void 0:I[0];if(D==null)return;const X=D.content,oe=le({groundingMetadata:D.groundingMetadata,generateId:s});if(oe!=null)for(const H of oe)H.sourceType==="url"&&!n.has(H.url)&&(n.add(H.url),T.enqueue(H));if(X!=null){const H=(L=X.parts)!=null?L:[];for(const f of H)if("executableCode"in f&&((K=f.executableCode)!=null&&K.code)){const P=s();S=P,T.enqueue({type:"tool-call",toolCallId:P,toolName:"code_execution",input:JSON.stringify(f.executableCode),providerExecuted:!0}),u=!0}else if("codeExecutionResult"in f&&f.codeExecutionResult){const P=S;P&&(T.enqueue({type:"tool-result",toolCallId:P,toolName:"code_execution",result:{outcome:f.codeExecutionResult.outcome,output:f.codeExecutionResult.output},providerExecuted:!0}),S=void 0)}else"text"in f&&f.text!=null&&f.text.length>0?f.thought===!0?(g!==null&&(T.enqueue({type:"text-end",id:g}),g=null),t===null&&(t=String(y++),T.enqueue({type:"reasoning-start",id:t,providerMetadata:f.thoughtSignature?{google:{thoughtSignature:f.thoughtSignature}}:void 0})),T.enqueue({type:"reasoning-delta",id:t,delta:f.text,providerMetadata:f.thoughtSignature?{google:{thoughtSignature:f.thoughtSignature}}:void 0})):(t!==null&&(T.enqueue({type:"reasoning-end",id:t}),t=null),g===null&&(g=String(y++),T.enqueue({type:"text-start",id:g,providerMetadata:f.thoughtSignature?{google:{thoughtSignature:f.thoughtSignature}}:void 0})),T.enqueue({type:"text-delta",id:g,delta:f.text,providerMetadata:f.thoughtSignature?{google:{thoughtSignature:f.thoughtSignature}}:void 0})):"inlineData"in f&&T.enqueue({type:"file",mediaType:f.inlineData.mimeType,data:f.inlineData.data});const ne=De({parts:X.parts,generateId:s});if(ne!=null)for(const f of ne)T.enqueue({type:"tool-input-start",id:f.toolCallId,toolName:f.toolName,providerMetadata:f.providerMetadata}),T.enqueue({type:"tool-input-delta",id:f.toolCallId,delta:f.args,providerMetadata:f.providerMetadata}),T.enqueue({type:"tool-input-end",id:f.toolCallId,providerMetadata:f.providerMetadata}),T.enqueue({type:"tool-call",toolCallId:f.toolCallId,toolName:f.toolName,input:f.args,providerMetadata:f.providerMetadata}),u=!0}D.finishReason!=null&&(h=se({finishReason:D.finishReason,hasToolCalls:u}),o={google:{promptFeedback:(C=Q.promptFeedback)!=null?C:null,groundingMetadata:(U=D.groundingMetadata)!=null?U:null,urlContextMetadata:(ee=D.urlContextMetadata)!=null?ee:null,safetyRatings:(te=D.safetyRatings)!=null?te:null}},N!=null&&(o.google.usageMetadata=N))},flush(x){g!==null&&x.enqueue({type:"text-end",id:g}),t!==null&&x.enqueue({type:"reasoning-end",id:t}),x.enqueue({type:"finish",finishReason:h,usage:i,providerMetadata:o})}})),response:{headers:v},request:{body:p}}}};function De({parts:e,generateId:l}){const c=e?.filter(p=>"functionCall"in p);return c==null||c.length===0?void 0:c.map(p=>({type:"tool-call",toolCallId:l(),toolName:p.functionCall.name,args:JSON.stringify(p.functionCall.args),providerMetadata:p.thoughtSignature?{google:{thoughtSignature:p.thoughtSignature}}:void 0}))}function le({groundingMetadata:e,generateId:l}){var c,p,a,v;if(!e?.groundingChunks)return;const m=[];for(const h of e.groundingChunks)if(h.web!=null)m.push({type:"source",sourceType:"url",id:l(),url:h.web.uri,title:(c=h.web.title)!=null?c:void 0});else if(h.retrievedContext!=null){const i=h.retrievedContext.uri,o=h.retrievedContext.fileSearchStore;if(i&&(i.startsWith("http://")||i.startsWith("https://")))m.push({type:"source",sourceType:"url",id:l(),url:i,title:(p=h.retrievedContext.title)!=null?p:void 0});else if(i){const s=(a=h.retrievedContext.title)!=null?a:"Unknown Document";let u="application/octet-stream",g;i.endsWith(".pdf")?(u="application/pdf",g=i.split("/").pop()):i.endsWith(".txt")?(u="text/plain",g=i.split("/").pop()):i.endsWith(".docx")?(u="application/vnd.openxmlformats-officedocument.wordprocessingml.document",g=i.split("/").pop()):i.endsWith(".doc")?(u="application/msword",g=i.split("/").pop()):(i.match(/\.(md|markdown)$/)&&(u="text/markdown"),g=i.split("/").pop()),m.push({type:"source",sourceType:"document",id:l(),mediaType:u,title:s,filename:g})}else if(o){const s=(v=h.retrievedContext.title)!=null?v:"Unknown Document";m.push({type:"source",sourceType:"document",id:l(),mediaType:"application/octet-stream",title:s,filename:o.split("/").pop()})}}return m.length>0?m:void 0}var de=()=>r({webSearchQueries:_(d()).nullish(),retrievalQueries:_(d()).nullish(),searchEntryPoint:r({renderedContent:d()}).nullish(),groundingChunks:_(r({web:r({uri:d(),title:d().nullish()}).nullish(),retrievedContext:r({uri:d().nullish(),title:d().nullish(),text:d().nullish(),fileSearchStore:d().nullish()}).nullish()})).nullish(),groundingSupports:_(r({segment:r({startIndex:b().nullish(),endIndex:b().nullish(),text:d().nullish()}),segment_text:d().nullish(),groundingChunkIndices:_(b()).nullish(),supportChunkIndices:_(b()).nullish(),confidenceScores:_(b()).nullish(),confidenceScore:_(b()).nullish()})).nullish(),retrievalMetadata:ue([r({webDynamicRetrievalScore:b()}),r({})]).nullish()}),ce=()=>r({parts:_(ue([r({functionCall:r({name:d(),args:be()}),thoughtSignature:d().nullish()}),r({inlineData:r({mimeType:d(),data:d()})}),r({executableCode:r({language:d(),code:d()}).nullish(),codeExecutionResult:r({outcome:d(),output:d()}).nullish(),text:d().nullish(),thought:F().nullish(),thoughtSignature:d().nullish()})])).nullish()}),J=()=>r({category:d().nullish(),probability:d().nullish(),probabilityScore:b().nullish(),severity:d().nullish(),severityScore:b().nullish(),blocked:F().nullish()}),ge=r({cachedContentTokenCount:b().nullish(),thoughtsTokenCount:b().nullish(),promptTokenCount:b().nullish(),candidatesTokenCount:b().nullish(),totalTokenCount:b().nullish(),trafficType:d().nullish()}),pe=()=>r({urlMetadata:_(r({retrievedUrl:d(),urlRetrievalStatus:d()}))}),Ge=w(()=>O(r({candidates:_(r({content:ce().nullish().or(r({}).strict()),finishReason:d().nullish(),safetyRatings:_(J()).nullish(),groundingMetadata:de().nullish(),urlContextMetadata:pe().nullish()})),usageMetadata:ge.nullish(),promptFeedback:r({blockReason:d().nullish(),safetyRatings:_(J()).nullish()}).nullish()}))),Le=w(()=>O(r({candidates:_(r({content:ce().nullish(),finishReason:d().nullish(),safetyRatings:_(J()).nullish(),groundingMetadata:de().nullish(),urlContextMetadata:pe().nullish()})).nullish(),usageMetadata:ge.nullish(),promptFeedback:r({blockReason:d().nullish(),safetyRatings:_(J()).nullish()}).nullish()}))),He=fe({id:"google.code_execution",name:"code_execution",inputSchema:r({language:d().describe("The programming language of the code."),code:d().describe("The code to be executed.")}),outputSchema:r({outcome:d().describe('The outcome of the execution (e.g., "OUTCOME_OK").'),output:d().describe("The output from the code execution.")})}),Ue=r({fileSearchStoreNames:_(d()).describe("The names of the file_search_stores to retrieve from. Example: `fileSearchStores/my-file-search-store-123`"),topK:b().int().positive().describe("The number of file search retrieval chunks to retrieve.").optional(),metadataFilter:d().describe("Metadata filter to apply to the file search retrieval documents. See https://google.aip.dev/160 for the syntax of the filter expression.").optional()}).passthrough(),Pe=w(()=>O(Ue)),Fe=z({id:"google.file_search",name:"file_search",inputSchema:Pe}),qe=z({id:"google.google_search",name:"google_search",inputSchema:w(()=>O(r({mode:R(["MODE_DYNAMIC","MODE_UNSPECIFIED"]).default("MODE_UNSPECIFIED"),dynamicThreshold:b().default(1)})))}),Ve=z({id:"google.url_context",name:"url_context",inputSchema:w(()=>O(r({})))}),Be=z({id:"google.vertex_rag_store",name:"vertex_rag_store",inputSchema:r({ragCorpus:d(),topK:b().optional()})}),Ke={googleSearch:qe,urlContext:Ve,fileSearch:Fe,codeExecution:He,vertexRagStore:Be},$e=class{constructor(e,l,c){this.modelId=e,this.settings=l,this.config=c,this.specificationVersion="v2"}get maxImagesPerCall(){var e;return(e=this.settings.maxImagesPerCall)!=null?e:4}get provider(){return this.config.provider}async doGenerate(e){var l,c,p;const{prompt:a,n:v=1,size:m="1024x1024",aspectRatio:h="1:1",seed:i,providerOptions:o,headers:s,abortSignal:u}=e,g=[];m!=null&&g.push({type:"unsupported-setting",setting:"size",details:"This model does not support the `size` option. Use `aspectRatio` instead."}),i!=null&&g.push({type:"unsupported-setting",setting:"seed",details:"This model does not support the `seed` option through this provider."});const t=await Z({provider:"google",providerOptions:o,schema:We}),y=(p=(c=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:c.call(l))!=null?p:new Date,n={sampleCount:v};h!=null&&(n.aspectRatio=h),t&&Object.assign(n,t);const S={instances:[{prompt:a}],parameters:n},{responseHeaders:x,value:T}=await q({url:`${this.config.baseURL}/models/${this.modelId}:predict`,headers:Y(await W(this.config.headers),s),body:S,failedResponseHandler:V,successfulResponseHandler:j(Ye),abortSignal:u,fetch:this.config.fetch});return{images:T.predictions.map(M=>M.bytesBase64Encoded),warnings:g??[],providerMetadata:{google:{images:T.predictions.map(M=>({}))}},response:{timestamp:y,modelId:this.modelId,headers:x}}}},Ye=w(()=>O(r({predictions:_(r({bytesBase64Encoded:d()})).default([])}))),We=w(()=>O(r({personGeneration:R(["dont_allow","allow_adult","allow_all"]).nullish(),aspectRatio:R(["1:1","3:4","4:3","9:16","16:9"]).nullish()})));function je(e={}){var l,c;const p=(l=he(e.baseURL))!=null?l:"https://generativelanguage.googleapis.com/v1beta",a=(c=e.name)!=null?c:"google.generative-ai",v=()=>me({"x-goog-api-key":Ce({apiKey:e.apiKey,environmentVariableName:"GOOGLE_GENERATIVE_AI_API_KEY",description:"Google Generative AI"}),...e.headers},`ai-sdk/google/${Se}`),m=s=>{var u;return new Ne(s,{provider:a,baseURL:p,headers:v,generateId:(u=e.generateId)!=null?u:re,supportedUrls:()=>({"*":[new RegExp(`^${p}/files/.*$`),new RegExp("^https://(?:www\\.)?youtube\\.com/watch\\?v=[\\w-]+(?:&[\\w=&.-]*)?$"),new RegExp("^https://youtu\\.be/[\\w-]+(?:\\?[\\w=&.-]*)?$")]}),fetch:e.fetch})},h=s=>new Ee(s,{provider:a,baseURL:p,headers:v,fetch:e.fetch}),i=(s,u={})=>new $e(s,u,{provider:a,baseURL:p,headers:v,fetch:e.fetch}),o=function(s){if(new.target)throw new Error("The Google Generative AI model function cannot be called with the new keyword.");return m(s)};return o.languageModel=m,o.chat=m,o.generativeAI=m,o.embedding=h,o.textEmbedding=h,o.textEmbeddingModel=h,o.image=i,o.imageModel=i,o.tools=Ke,o}var Xe=je();export{Se as VERSION,je as createGoogleGenerativeAI,Xe as google};
//# sourceMappingURL=index-Bne2JJcv.js.map
