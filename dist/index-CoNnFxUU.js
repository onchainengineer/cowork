import{o as u,a as $,s as c,n as y,_ as Ae,l as D,b as B,u as Ne,c as St,r as Et}from"./main-C7IUlwtB.js";import"./__vite-browser-external-2447137e-qv044l9q.js";var Rt={},Ct=Object.defineProperty,$t=Object.defineProperties,At=Object.getOwnPropertyDescriptors,Oe=Object.getOwnPropertySymbols,Nt=Object.prototype.hasOwnProperty,Pt=Object.prototype.propertyIsEnumerable,Se=(e,t,n)=>t in e?Ct(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,T=(e,t)=>{for(var n in t||(t={}))Nt.call(t,n)&&Se(e,n,t[n]);if(Oe)for(var n of Oe(t))Pt.call(t,n)&&Se(e,n,t[n]);return e},Y=(e,t)=>$t(e,At(t)),Pe="vercel.ai.error",Dt=Symbol.for(Pe),De,qt=class qe extends Error{constructor({name:t,message:n,cause:o}){super(n),this[De]=!0,this.name=t,this.cause=o}static isInstance(t){return qe.hasMarker(t,Pe)}static hasMarker(t,n){const o=Symbol.for(n);return t!=null&&typeof t=="object"&&o in t&&typeof t[o]=="boolean"&&t[o]===!0}};De=Dt;var N=qt,Me="AI_APICallError",je=`vercel.ai.error.${Me}`,Mt=Symbol.for(je),Ue,V=class extends N{constructor({message:e,url:t,requestBodyValues:n,statusCode:o,responseHeaders:s,responseBody:r,cause:p,isRetryable:i=o!=null&&(o===408||o===409||o===429||o>=500),data:l}){super({name:Me,message:e,cause:p}),this[Ue]=!0,this.url=t,this.requestBodyValues=n,this.statusCode=o,this.responseHeaders=s,this.responseBody=r,this.isRetryable=i,this.data=l}static isInstance(e){return N.hasMarker(e,je)}};Ue=Mt;var Ve="AI_EmptyResponseBodyError",Be=`vercel.ai.error.${Ve}`,jt=Symbol.for(Be),Le,Ut=class extends N{constructor({message:e="Empty response body"}={}){super({name:Ve,message:e}),this[Le]=!0}static isInstance(e){return N.hasMarker(e,Be)}};Le=jt;function He(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var Je="AI_InvalidArgumentError",Ge=`vercel.ai.error.${Je}`,Vt=Symbol.for(Ge),We,Fe=class extends N{constructor({message:e,cause:t,argument:n}){super({name:Je,message:e,cause:t}),this[We]=!0,this.argument=n}static isInstance(e){return N.hasMarker(e,Ge)}};We=Vt;var Ke="AI_InvalidPromptError",ze=`vercel.ai.error.${Ke}`,Bt=Symbol.for(ze),Ye,Lt=class extends N{constructor({prompt:e,message:t,cause:n}){super({name:Ke,message:`Invalid prompt: ${t}`,cause:n}),this[Ye]=!0,this.prompt=e}static isInstance(e){return N.hasMarker(e,ze)}};Ye=Bt;var Ze="AI_InvalidResponseDataError",Xe=`vercel.ai.error.${Ze}`,Ht=Symbol.for(Xe),Qe,ee=class extends N{constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:Ze,message:t}),this[Qe]=!0,this.data=e}static isInstance(e){return N.hasMarker(e,Xe)}};Qe=Ht;var et="AI_JSONParseError",tt=`vercel.ai.error.${et}`,Jt=Symbol.for(tt),nt,ae=class extends N{constructor({text:e,cause:t}){super({name:et,message:`JSON parsing failed: Text: ${e}.
Error message: ${He(t)}`,cause:t}),this[nt]=!0,this.text=e}static isInstance(e){return N.hasMarker(e,tt)}};nt=Jt;var ot="AI_LoadAPIKeyError",st=`vercel.ai.error.${ot}`,Gt=Symbol.for(st),rt,se=class extends N{constructor({message:e}){super({name:ot,message:e}),this[rt]=!0}static isInstance(e){return N.hasMarker(e,st)}};rt=Gt;var at="AI_NoContentGeneratedError",it=`vercel.ai.error.${at}`,Wt=Symbol.for(it),lt,ut=class extends N{constructor({message:e="No content generated."}={}){super({name:at,message:e}),this[lt]=!0}static isInstance(e){return N.hasMarker(e,it)}};lt=Wt;var ct="AI_TypeValidationError",pt=`vercel.ai.error.${ct}`,Ft=Symbol.for(pt),dt,Kt=class me extends N{constructor({value:t,cause:n}){super({name:ct,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${He(n)}`,cause:n}),this[dt]=!0,this.value=t}static isInstance(t){return N.hasMarker(t,pt)}static wrap({value:t,cause:n}){return me.isInstance(n)&&n.value===t?n:new me({value:t,cause:n})}};dt=Ft;var te=Kt,ht="AI_UnsupportedFunctionalityError",gt=`vercel.ai.error.${ht}`,zt=Symbol.for(gt),ft,W=class extends N{constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:ht,message:t}),this[ft]=!0,this.functionality=e}static isInstance(e){return N.hasMarker(e,gt)}};ft=zt;var Ee=class extends Error{constructor(e,t){super(e),this.name="ParseError",this.type=t.type,this.field=t.field,this.value=t.value,this.line=t.line}};function he(e){}function Yt(e){if(typeof e=="function")throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");const{onEvent:t=he,onError:n=he,onRetry:o=he,onComment:s}=e;let r="",p=!0,i,l="",d="";function f(a){const v=p?a.replace(/^\xEF\xBB\xBF/,""):a,[O,S]=Zt(`${r}${v}`);for(const g of O)h(g);r=S,p=!1}function h(a){if(a===""){b();return}if(a.startsWith(":")){s&&s(a.slice(a.startsWith(": ")?2:1));return}const v=a.indexOf(":");if(v!==-1){const O=a.slice(0,v),S=a[v+1]===" "?2:1,g=a.slice(v+S);_(O,g,a);return}_(a,"",a)}function _(a,v,O){switch(a){case"event":d=v;break;case"data":l=`${l}${v}
`;break;case"id":i=v.includes("\0")?void 0:v;break;case"retry":/^\d+$/.test(v)?o(parseInt(v,10)):n(new Ee(`Invalid \`retry\` value: "${v}"`,{type:"invalid-retry",value:v,line:O}));break;default:n(new Ee(`Unknown field "${a.length>20?`${a.slice(0,20)}…`:a}"`,{type:"unknown-field",field:a,value:v,line:O}));break}}function b(){l.length>0&&t({id:i,event:d||void 0,data:l.endsWith(`
`)?l.slice(0,-1):l}),i=void 0,l="",d=""}function m(a={}){r&&a.consume&&h(r),p=!0,i=void 0,l="",d="",r=""}return{feed:f,reset:m}}function Zt(e){const t=[];let n="",o=0;for(;o<e.length;){const s=e.indexOf("\r",o),r=e.indexOf(`
`,o);let p=-1;if(s!==-1&&r!==-1?p=Math.min(s,r):s!==-1?p=s:r!==-1&&(p=r),p===-1){n=e.slice(o);break}else{const i=e.slice(o,p);t.push(i),o=p+1,e[o-1]==="\r"&&e[o]===`
`&&o++}}return[t,n]}var Xt=class extends TransformStream{constructor({onError:e,onRetry:t,onComment:n}={}){let o;super({start(s){o=Yt({onEvent:r=>{s.enqueue(r)},onError(r){e==="terminate"?s.error(r):typeof e=="function"&&e(r)},onRetry:t,onComment:n})},transform(s){o.feed(s)}})}};new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function ie(...e){return e.reduce((t,n)=>T(T({},t),n??{}),{})}function pe(e){return Object.fromEntries([...e.headers])}var Qt=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:o="-"}={})=>{const s=()=>{const r=n.length,p=new Array(t);for(let i=0;i<t;i++)p[i]=n[Math.random()*r|0];return p.join("")};if(e==null)return s;if(n.includes(o))throw new Fe({argument:"separator",message:`The separator "${o}" must not be part of the alphabet "${n}".`});return()=>`${e}${o}${s()}`},U=Qt();function _e(e){return(e instanceof Error||e instanceof DOMException)&&(e.name==="AbortError"||e.name==="ResponseAborted"||e.name==="TimeoutError")}var en=["fetch failed","failed to fetch"];function tn({error:e,url:t,requestBodyValues:n}){if(_e(e))return e;if(e instanceof TypeError&&en.includes(e.message.toLowerCase())){const o=e.cause;if(o!=null)return new V({message:`Cannot connect to API: ${o.message}`,cause:o,url:t,requestBodyValues:n,isRetryable:!0})}return e}function nn(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>n!=null))}function mt({apiKey:e,environmentVariableName:t,apiKeyParameterName:n="apiKey",description:o}){if(typeof e=="string")return e;if(e!=null)throw new se({message:`${o} API key must be a string.`});if(typeof process>"u")throw new se({message:`${o} API key is missing. Pass it using the '${n}' parameter. Environment variables is not supported in this environment.`});if(e=Rt[t],e==null)throw new se({message:`${o} API key is missing. Pass it using the '${n}' parameter or the ${t} environment variable.`});if(typeof e!="string")throw new se({message:`${o} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}var on=/"__proto__"\s*:/,sn=/"constructor"\s*:/;function rn(e){const t=JSON.parse(e);return t===null||typeof t!="object"||on.test(e)===!1&&sn.test(e)===!1?t:an(t)}function an(e){let t=[e];for(;t.length;){const n=t;t=[];for(const o of n){if(Object.prototype.hasOwnProperty.call(o,"__proto__"))throw new SyntaxError("Object contains forbidden prototype property");if(Object.prototype.hasOwnProperty.call(o,"constructor")&&Object.prototype.hasOwnProperty.call(o.constructor,"prototype"))throw new SyntaxError("Object contains forbidden prototype property");for(const s in o){const r=o[s];r&&typeof r=="object"&&t.push(r)}}}return e}function ke(e){const{stackTraceLimit:t}=Error;Error.stackTraceLimit=0;try{return rn(e)}finally{Error.stackTraceLimit=t}}var ve=Symbol.for("vercel.ai.validator");function ln(e){return{[ve]:!0,validate:e}}function un(e){return typeof e=="object"&&e!==null&&ve in e&&e[ve]===!0&&"validate"in e}function cn(e){return un(e)?e:pn(e)}function pn(e){return ln(async t=>{const n=await e["~standard"].validate(t);return n.issues==null?{success:!0,value:n.value}:{success:!1,error:new te({value:t,cause:n.issues})}})}async function dn({value:e,schema:t}){const n=await _t({value:e,schema:t});if(!n.success)throw te.wrap({value:e,cause:n.error});return n.value}async function _t({value:e,schema:t}){const n=cn(t);try{if(n.validate==null)return{success:!0,value:e,rawValue:e};const o=await n.validate(e);return o.success?{success:!0,value:o.value,rawValue:e}:{success:!1,error:te.wrap({value:e,cause:o.error}),rawValue:e}}catch(o){return{success:!1,error:te.wrap({value:e,cause:o}),rawValue:e}}}async function hn({text:e,schema:t}){try{const n=ke(e);return t==null?n:dn({value:n,schema:t})}catch(n){throw ae.isInstance(n)||te.isInstance(n)?n:new ae({text:e,cause:n})}}async function vt({text:e,schema:t}){try{const n=ke(e);return t==null?{success:!0,value:n,rawValue:n}:await _t({value:n,schema:t})}catch(n){return{success:!1,error:ae.isInstance(n)?n:new ae({text:e,cause:n}),rawValue:void 0}}}function ge(e){try{return ke(e),!0}catch{return!1}}function gn({stream:e,schema:t}){return e.pipeThrough(new TextDecoderStream).pipeThrough(new Xt).pipeThrough(new TransformStream({async transform({data:n},o){n!=="[DONE]"&&o.enqueue(await vt({text:n,schema:t}))}}))}var fn=()=>globalThis.fetch,le=async({url:e,headers:t,body:n,failedResponseHandler:o,successfulResponseHandler:s,abortSignal:r,fetch:p})=>mn({url:e,headers:T({"Content-Type":"application/json"},t),body:{content:JSON.stringify(n),values:n},failedResponseHandler:o,successfulResponseHandler:s,abortSignal:r,fetch:p}),mn=async({url:e,headers:t={},body:n,successfulResponseHandler:o,failedResponseHandler:s,abortSignal:r,fetch:p=fn()})=>{try{const i=await p(e,{method:"POST",headers:nn(t),body:n.content,signal:r}),l=pe(i);if(!i.ok){let d;try{d=await s({response:i,url:e,requestBodyValues:n.values})}catch(f){throw _e(f)||V.isInstance(f)?f:new V({message:"Failed to process error response",cause:f,statusCode:i.status,url:e,responseHeaders:l,requestBodyValues:n.values})}throw d.value}try{return await o({response:i,url:e,requestBodyValues:n.values})}catch(d){throw d instanceof Error&&(_e(d)||V.isInstance(d))?d:new V({message:"Failed to process successful response",cause:d,statusCode:i.status,url:e,responseHeaders:l,requestBodyValues:n.values})}}catch(i){throw tn({error:i,url:e,requestBodyValues:n.values})}},_n=({errorSchema:e,errorToMessage:t,isRetryable:n})=>async({response:o,url:s,requestBodyValues:r})=>{const p=await o.text(),i=pe(o);if(p.trim()==="")return{responseHeaders:i,value:new V({message:o.statusText,url:s,requestBodyValues:r,statusCode:o.status,responseHeaders:i,responseBody:p,isRetryable:n?.(o)})};try{const l=await hn({text:p,schema:e});return{responseHeaders:i,value:new V({message:t(l),url:s,requestBodyValues:r,statusCode:o.status,responseHeaders:i,responseBody:p,data:l,isRetryable:n?.(o,l)})}}catch{return{responseHeaders:i,value:new V({message:o.statusText,url:s,requestBodyValues:r,statusCode:o.status,responseHeaders:i,responseBody:p,isRetryable:n?.(o)})}}},yt=e=>async({response:t})=>{const n=pe(t);if(t.body==null)throw new Ut({});return{responseHeaders:n,value:gn({stream:t.body,schema:e})}},bt=e=>async({response:t,url:n,requestBodyValues:o})=>{const s=await t.text(),r=await vt({text:s,schema:e}),p=pe(t);if(!r.success)throw new V({message:"Invalid JSON response",cause:r.error,statusCode:t.status,responseHeaders:p,responseBody:s,url:n,requestBodyValues:o});return{responseHeaders:p,value:r.value,rawValue:r.rawValue}},{btoa:vn}=globalThis;function yn(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return vn(t)}function kt(e){return e?.replace(/\/$/,"")}function fe(e){return e!=null}var wt=(e=>(e.Unknown="unknown",e.OpenAIResponsesV1="openai-responses-v1",e.XAIResponsesV1="xai-responses-v1",e.AnthropicClaudeV1="anthropic-claude-v1",e.GoogleGeminiV1="google-gemini-v1",e))(wt||{}),we=u({id:c().nullish(),format:Ae(wt).nullish(),index:y().optional()}).loose(),bn=u({type:D("reasoning.summary"),summary:c()}).extend(we.shape),kn=u({type:D("reasoning.encrypted"),data:c()}).extend(we.shape),wn=u({type:D("reasoning.text"),text:c().nullish(),signature:c().nullish()}).extend(we.shape),xe=B([bn,kn,wn]),re=B([xe,Ne().transform(()=>null)]),Te=$(re).transform(e=>e.filter(t=>!!t));B([u({delta:u({reasoning_details:$(re)})}).transform(e=>e.delta.reasoning_details.filter(fe)),u({message:u({reasoning_details:$(re)})}).transform(e=>e.message.reasoning_details.filter(fe)),u({text:c(),reasoning_details:$(re)}).transform(e=>e.reasoning_details.filter(fe))]);var de=u({error:u({code:B([c(),y()]).nullable().optional().default(null),message:c(),type:c().nullable().optional().default(null),param:St().nullable().optional().default(null)}).passthrough()}).passthrough(),ue=_n({errorSchema:de,errorToMessage:e=>e.error.message}),xn=u({provider:c(),reasoning_details:$(xe).optional(),usage:u({promptTokens:y(),promptTokensDetails:u({cachedTokens:y()}).passthrough().optional(),completionTokens:y(),completionTokensDetails:u({reasoningTokens:y()}).passthrough().optional(),totalTokens:y(),cost:y().optional(),costDetails:u({upstreamInferenceCost:y()}).passthrough().optional()}).passthrough()}).passthrough(),Re=u({openrouter:u({reasoning_details:$(xe).optional()}).optional()}).optional();function ce(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}function Ie({url:e,protocols:t}){try{const n=new URL(e);return t.has(n.protocol)}catch{return!1}}function ye({part:e,defaultMediaType:t}){var n,o;if(e.data instanceof Uint8Array){const r=yn(e.data);return`data:${(n=e.mediaType)!=null?n:t};base64,${r}`}const s=e.data.toString();return Ie({url:s,protocols:new Set(["http:","https:"])})||s.startsWith("data:")?s:`data:${(o=e.mediaType)!=null?o:t};base64,${s}`}function Ce(e,t){var n;const o=e.match(/^data:([^;]+)/);return o&&(n=o[1])!=null?n:t}function be(e){const t=e.match(/^data:[^;]*;base64,(.+)$/);return t?t[1]:e}function Tn(e){const t=ye({part:e,defaultMediaType:"audio/mpeg"});if(Ie({url:t,protocols:new Set(["http:","https:"])}))throw new Error(`Audio files cannot be provided as URLs.

OpenRouter requires audio to be base64-encoded. Please:
1. Download the audio file locally
2. Read it as a Buffer or Uint8Array
3. Pass it as the data parameter

The AI SDK will automatically handle base64 encoding.

Learn more: https://openrouter.ai/docs/features/multimodal/audio`);const n=be(t),o=e.mediaType||"audio/mpeg";let s=o.replace("audio/","");if(s==="mpeg"||s==="mp3"?s="mp3":(s==="x-wav"||s==="wave"||s==="wav")&&(s="wav"),s!=="mp3"&&s!=="wav")throw new Error(`Unsupported audio format: "${o}"

OpenRouter only supports MP3 and WAV audio formats.
• For MP3: use "audio/mpeg" or "audio/mp3"
• For WAV: use "audio/wav" or "audio/x-wav"

Learn more: https://openrouter.ai/docs/features/multimodal/audio`);return{data:n,format:s}}function G(e){var t,n,o;const s=e?.anthropic,r=e?.openrouter;return(o=(n=(t=r?.cacheControl)!=null?t:r?.cache_control)!=null?n:s?.cacheControl)!=null?o:s?.cache_control}function In(e){var t,n,o,s,r,p,i,l;const d=[];for(const{role:f,content:h,providerOptions:_}of e)switch(f){case"system":{d.push({role:"system",content:h,cache_control:G(_)});break}case"user":{if(h.length===1&&((t=h[0])==null?void 0:t.type)==="text"){const a=(n=G(_))!=null?n:G(h[0].providerOptions),v=a?[{type:"text",text:h[0].text,cache_control:a}]:h[0].text;d.push({role:"user",content:v});break}const b=G(_),m=h.map(a=>{var v,O,S,g,E,I,j;const H=(v=G(a.providerOptions))!=null?v:b;switch(a.type){case"text":return{type:"text",text:a.text,cache_control:H};case"file":{if((O=a.mediaType)!=null&&O.startsWith("image/"))return{type:"image_url",image_url:{url:ye({part:a,defaultMediaType:"image/jpeg"})},cache_control:H};if((S=a.mediaType)!=null&&S.startsWith("audio/"))return{type:"input_audio",input_audio:Tn(a),cache_control:H};const F=String((j=(I=(E=(g=a.providerOptions)==null?void 0:g.openrouter)==null?void 0:E.filename)!=null?I:a.filename)!=null?j:""),L=ye({part:a,defaultMediaType:"application/pdf"});return Ie({url:L,protocols:new Set(["http:","https:"])})?{type:"file",file:{filename:F,file_data:L}}:{type:"file",file:{filename:F,file_data:L},cache_control:H}}default:return{type:"text",text:"",cache_control:H}}});d.push({role:"user",content:m});break}case"assistant":{let b="",m="";const a=[],v=[];for(const E of h)switch(E.type){case"text":{b+=E.text;break}case"tool-call":{const I=(o=E.providerOptions)==null?void 0:o.openrouter;I?.reasoning_details&&Array.isArray(I.reasoning_details)&&v.push(...I.reasoning_details),a.push({id:E.toolCallId,type:"function",function:{name:E.toolName,arguments:JSON.stringify(E.input)}});break}case"reasoning":{m+=E.text;const I=Re.safeParse(E.providerOptions);I.success&&((r=(s=I.data)==null?void 0:s.openrouter)!=null&&r.reasoning_details)&&v.push(...I.data.openrouter.reasoning_details);break}}const O=Re.safeParse(_),S=O.success?(i=(p=O.data)==null?void 0:p.openrouter)==null?void 0:i.reasoning_details:void 0,g=S&&Array.isArray(S)&&S.length>0?S:v.length>0?v:void 0;d.push({role:"assistant",content:b,tool_calls:a.length>0?a:void 0,reasoning:m||void 0,reasoning_details:g,cache_control:G(_)});break}case"tool":{for(const b of h){const m=On(b);d.push({role:"tool",tool_call_id:b.toolCallId,content:m,cache_control:(l=G(_))!=null?l:G(b.providerOptions)})}break}}return d}function On(e){return e.output.type==="text"?e.output.value:JSON.stringify(e.output.value)}B([D("auto"),D("none"),D("required"),u({type:D("function"),function:u({name:c()})})]);function Sn(e){switch(e.type){case"auto":case"none":case"required":return e.type;case"tool":return{type:"function",function:{name:e.toolName}};default:throw new Fe({argument:"toolChoice",message:`Invalid tool choice type: ${JSON.stringify(e)}`})}}var En=u({type:D("image_url"),image_url:u({url:c()}).passthrough()}).passthrough(),Rn=B([En,Ne().transform(()=>null)]),xt=$(Rn).transform(e=>e.filter(t=>!!t)),Tt=u({id:c().optional(),model:c().optional(),provider:c().optional(),usage:u({prompt_tokens:y(),prompt_tokens_details:u({cached_tokens:y()}).passthrough().nullish(),completion_tokens:y(),completion_tokens_details:u({reasoning_tokens:y()}).passthrough().nullish(),total_tokens:y(),cost:y().optional(),cost_details:u({upstream_inference_cost:y().nullish()}).passthrough().nullish()}).passthrough().nullish()}).passthrough(),Cn=B([Tt.extend({choices:$(u({message:u({role:D("assistant"),content:c().nullable().optional(),reasoning:c().nullable().optional(),reasoning_details:Te.nullish(),images:xt.nullish(),tool_calls:$(u({id:c().optional().nullable(),type:D("function"),function:u({name:c(),arguments:c()}).passthrough()}).passthrough()).optional(),annotations:$(B([u({type:D("url_citation"),url_citation:u({end_index:y(),start_index:y(),title:c(),url:c(),content:c().optional()}).passthrough()}).passthrough(),u({type:D("file_annotation"),file_annotation:u({file_id:c(),quote:c().optional()}).passthrough()}).passthrough(),u({type:D("file"),file:u({hash:c(),name:c(),content:$(u({type:c(),text:c().optional()}).passthrough()).optional()}).passthrough()}).passthrough()])).nullish()}).passthrough(),index:y().nullish(),logprobs:u({content:$(u({token:c(),logprob:y(),top_logprobs:$(u({token:c(),logprob:y()}).passthrough())}).passthrough()).nullable()}).passthrough().nullable().optional(),finish_reason:c().optional().nullable()}).passthrough())}),de.extend({user_id:c().optional()})]),$n=B([Tt.extend({choices:$(u({delta:u({role:Ae(["assistant"]).optional(),content:c().nullish(),reasoning:c().nullish().optional(),reasoning_details:Te.nullish(),images:xt.nullish(),tool_calls:$(u({index:y().nullish(),id:c().nullish(),type:D("function").optional(),function:u({name:c().nullish(),arguments:c().nullish()}).passthrough()}).passthrough()).nullish(),annotations:$(B([u({type:D("url_citation"),url_citation:u({end_index:y(),start_index:y(),title:c(),url:c(),content:c().optional()}).passthrough()}).passthrough(),u({type:D("file_annotation"),file_annotation:u({file_id:c(),quote:c().optional()}).passthrough()}).passthrough(),u({type:D("file"),file:u({hash:c(),name:c(),content:$(u({type:c(),text:c().optional()}).passthrough()).optional()}).passthrough()}).passthrough()])).nullish()}).passthrough().nullish(),logprobs:u({content:$(u({token:c(),logprob:y(),top_logprobs:$(u({token:c(),logprob:y()}).passthrough())}).passthrough()).nullable()}).passthrough().nullish(),finish_reason:c().nullable().optional(),index:y().nullish()}).passthrough())}),de]),It=class{constructor(e,t,n){this.specificationVersion="v2",this.provider="openrouter",this.defaultObjectGenerationMode="tool",this.supportedUrls={"image/*":[/^data:image\/[a-zA-Z]+;base64,/,/^https?:\/\/.+\.(jpg|jpeg|png|gif|webp)$/i],"application/*":[/^data:application\//,/^https?:\/\/.+$/]},this.modelId=e,this.settings=t,this.config=n}getArgs({prompt:e,maxOutputTokens:t,temperature:n,topP:o,frequencyPenalty:s,presencePenalty:r,seed:p,stopSequences:i,responseFormat:l,topK:d,tools:f,toolChoice:h}){var _;const b=T(T({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:t,temperature:n,top_p:o,frequency_penalty:s,presence_penalty:r,seed:p,stop:i,response_format:l,top_k:d,messages:In(e),include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning,usage:this.settings.usage,plugins:this.settings.plugins,web_search_options:this.settings.web_search_options,provider:this.settings.provider,debug:this.settings.debug},this.config.extraBody),this.settings.extraBody);if(l?.type==="json"&&l.schema!=null)return Y(T({},b),{response_format:{type:"json_schema",json_schema:T({schema:l.schema,strict:!0,name:(_=l.name)!=null?_:"response"},l.description&&{description:l.description})}});if(f&&f.length>0){const m=f.filter(a=>a.type==="function").map(a=>({type:"function",function:{name:a.name,description:a.description,parameters:a.inputSchema}}));return Y(T({},b),{tools:m,tool_choice:h?Sn(h):void 0})}return b}async doGenerate(e){var t,n,o,s,r,p,i,l,d,f,h,_,b,m,a,v,O,S,g,E,I,j;const F=(e.providerOptions||{}).openrouter||{},L=T(T({},this.getArgs(e)),F),{value:K,responseHeaders:Q}=await le({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:ie(this.config.headers(),e.headers),body:L,failedResponseHandler:ue,successfulResponseHandler:bt(Cn),abortSignal:e.abortSignal,fetch:this.config.fetch});if("error"in K){const x=K.error;throw new V({message:x.message,url:this.config.url({path:"/chat/completions",modelId:this.modelId}),requestBodyValues:L,statusCode:200,responseHeaders:Q,data:x})}const A=K,P=A.choices[0];if(!P)throw new ut({message:"No choice in response"});const z=A.usage?{inputTokens:(t=A.usage.prompt_tokens)!=null?t:0,outputTokens:(n=A.usage.completion_tokens)!=null?n:0,totalTokens:((o=A.usage.prompt_tokens)!=null?o:0)+((s=A.usage.completion_tokens)!=null?s:0),reasoningTokens:(p=(r=A.usage.completion_tokens_details)==null?void 0:r.reasoning_tokens)!=null?p:0,cachedInputTokens:(l=(i=A.usage.prompt_tokens_details)==null?void 0:i.cached_tokens)!=null?l:0}:{inputTokens:0,outputTokens:0,totalTokens:0,reasoningTokens:0,cachedInputTokens:0},Z=(d=P.message.reasoning_details)!=null?d:[],ne=Z.length>0?Z.map(x=>{switch(x.type){case"reasoning.text":{if(x.text)return{type:"reasoning",text:x.text,providerMetadata:{openrouter:{reasoning_details:[x]}}};break}case"reasoning.summary":{if(x.summary)return{type:"reasoning",text:x.summary,providerMetadata:{openrouter:{reasoning_details:[x]}}};break}case"reasoning.encrypted":{if(x.data)return{type:"reasoning",text:"[REDACTED]",providerMetadata:{openrouter:{reasoning_details:[x]}}};break}}return null}).filter(x=>x!==null):P.message.reasoning?[{type:"reasoning",text:P.message.reasoning}]:[],J=[];if(J.push(...ne),P.message.content&&J.push({type:"text",text:P.message.content}),P.message.tool_calls)for(const x of P.message.tool_calls)J.push({type:"tool-call",toolCallId:(f=x.id)!=null?f:U(),toolName:x.function.name,input:x.function.arguments,providerMetadata:{openrouter:{reasoning_details:Z}}});if(P.message.images)for(const x of P.message.images)J.push({type:"file",mediaType:Ce(x.image_url.url,"image/jpeg"),data:be(x.image_url.url)});if(P.message.annotations)for(const x of P.message.annotations)x.type==="url_citation"&&J.push({type:"source",sourceType:"url",id:x.url_citation.url,url:x.url_citation.url,title:x.url_citation.title,providerMetadata:{openrouter:{content:x.url_citation.content||""}}});return{content:J,finishReason:ce(P.finish_reason),usage:z,warnings:[],providerMetadata:{openrouter:xn.parse({provider:(h=A.provider)!=null?h:"",reasoning_details:(_=P.message.reasoning_details)!=null?_:[],usage:T(T(T({promptTokens:(b=z.inputTokens)!=null?b:0,completionTokens:(m=z.outputTokens)!=null?m:0,totalTokens:(a=z.totalTokens)!=null?a:0,cost:(v=A.usage)==null?void 0:v.cost},((S=(O=A.usage)==null?void 0:O.prompt_tokens_details)==null?void 0:S.cached_tokens)!=null?{promptTokensDetails:{cachedTokens:A.usage.prompt_tokens_details.cached_tokens}}:{}),((E=(g=A.usage)==null?void 0:g.completion_tokens_details)==null?void 0:E.reasoning_tokens)!=null?{completionTokensDetails:{reasoningTokens:A.usage.completion_tokens_details.reasoning_tokens}}:{}),((j=(I=A.usage)==null?void 0:I.cost_details)==null?void 0:j.upstream_inference_cost)!=null?{costDetails:{upstreamInferenceCost:A.usage.cost_details.upstream_inference_cost}}:{})})},request:{body:L},response:{id:A.id,modelId:A.model,headers:Q}}}async doStream(e){var t;const o=(e.providerOptions||{}).openrouter||{},s=T(T({},this.getArgs(e)),o),{value:r,responseHeaders:p}=await le({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:ie(this.config.headers(),e.headers),body:Y(T({},s),{stream:!0,stream_options:this.config.compatibility==="strict"?T({include_usage:!0},(t=this.settings.usage)!=null&&t.include?{include_usage:!0}:{}):void 0}),failedResponseHandler:ue,successfulResponseHandler:yt($n),abortSignal:e.abortSignal,fetch:this.config.fetch}),i=[];let l="other";const d={inputTokens:Number.NaN,outputTokens:Number.NaN,totalTokens:Number.NaN,reasoningTokens:Number.NaN,cachedInputTokens:Number.NaN},f={},h=[];let _=!1,b=!1,m,a,v,O;return{stream:r.pipeThrough(new TransformStream({transform(S,g){var E,I,j,H,F,L,K,Q,A,P,z,Z,ne,J,x;if(!S.success){l="error",g.enqueue({type:"error",error:S.error});return}const R=S.value;if("error"in R){l="error",g.enqueue({type:"error",error:R.error});return}if(R.provider&&(O=R.provider),R.id&&(v=R.id,g.enqueue({type:"response-metadata",id:R.id})),R.model&&g.enqueue({type:"response-metadata",modelId:R.model}),R.usage!=null){if(d.inputTokens=R.usage.prompt_tokens,d.outputTokens=R.usage.completion_tokens,d.totalTokens=R.usage.prompt_tokens+R.usage.completion_tokens,f.promptTokens=R.usage.prompt_tokens,R.usage.prompt_tokens_details){const w=(E=R.usage.prompt_tokens_details.cached_tokens)!=null?E:0;d.cachedInputTokens=w,f.promptTokensDetails={cachedTokens:w}}if(f.completionTokens=R.usage.completion_tokens,R.usage.completion_tokens_details){const w=(I=R.usage.completion_tokens_details.reasoning_tokens)!=null?I:0;d.reasoningTokens=w,f.completionTokensDetails={reasoningTokens:w}}f.cost=R.usage.cost,f.totalTokens=R.usage.total_tokens;const k=(j=R.usage.cost_details)==null?void 0:j.upstream_inference_cost;k!=null&&(f.costDetails={upstreamInferenceCost:k})}const X=R.choices[0];if(X?.finish_reason!=null&&(l=ce(X.finish_reason)),X?.delta==null)return;const q=X.delta,oe=(k,w)=>{b||(a=v||U(),g.enqueue({providerMetadata:w,type:"reasoning-start",id:a}),b=!0),g.enqueue({providerMetadata:w,type:"reasoning-delta",delta:k,id:a||U()})};if(q.reasoning_details&&q.reasoning_details.length>0){for(const w of q.reasoning_details)if(w.type==="reasoning.text"){const C=h[h.length-1];C?.type==="reasoning.text"?(C.text=(C.text||"")+(w.text||""),C.signature=C.signature||w.signature,C.format=C.format||w.format):h.push(T({},w))}else h.push(w);const k={openrouter:{reasoning_details:q.reasoning_details}};for(const w of q.reasoning_details)switch(w.type){case"reasoning.text":{w.text&&oe(w.text,k);break}case"reasoning.encrypted":{w.data&&oe("[REDACTED]",k);break}case"reasoning.summary":{w.summary&&oe(w.summary,k);break}}}else q.reasoning&&oe(q.reasoning);if(q.content&&(b&&!_&&(g.enqueue({type:"reasoning-end",id:a||U()}),b=!1),_||(m=v||U(),g.enqueue({type:"text-start",id:m}),_=!0),g.enqueue({type:"text-delta",delta:q.content,id:m||U()})),q.annotations)for(const k of q.annotations)k.type==="url_citation"&&g.enqueue({type:"source",sourceType:"url",id:k.url_citation.url,url:k.url_citation.url,title:k.url_citation.title,providerMetadata:{openrouter:{content:k.url_citation.content||""}}});if(q.tool_calls!=null)for(const k of q.tool_calls){const w=(H=k.index)!=null?H:i.length-1;if(i[w]==null){if(k.type!=="function")throw new ee({data:k,message:"Expected 'function' type."});if(k.id==null)throw new ee({data:k,message:"Expected 'id' to be a string."});if(((F=k.function)==null?void 0:F.name)==null)throw new ee({data:k,message:"Expected 'function.name' to be a string."});i[w]={id:k.id,type:"function",function:{name:k.function.name,arguments:(L=k.function.arguments)!=null?L:""},inputStarted:!1,sent:!1};const M=i[w];if(M==null)throw new ee({data:{index:w,toolCallsLength:i.length},message:`Tool call at index ${w} is missing after creation.`});((K=M.function)==null?void 0:K.name)!=null&&((Q=M.function)==null?void 0:Q.arguments)!=null&&ge(M.function.arguments)&&(M.inputStarted=!0,g.enqueue({type:"tool-input-start",id:M.id,toolName:M.function.name}),g.enqueue({type:"tool-input-delta",id:M.id,delta:M.function.arguments}),g.enqueue({type:"tool-input-end",id:M.id}),g.enqueue({type:"tool-call",toolCallId:M.id,toolName:M.function.name,input:M.function.arguments,providerMetadata:{openrouter:{reasoning_details:h}}}),M.sent=!0);continue}const C=i[w];if(C==null)throw new ee({data:{index:w,toolCallsLength:i.length,toolCallDelta:k},message:`Tool call at index ${w} is missing during merge.`});C.inputStarted||(C.inputStarted=!0,g.enqueue({type:"tool-input-start",id:C.id,toolName:C.function.name})),((A=k.function)==null?void 0:A.arguments)!=null&&(C.function.arguments+=(z=(P=k.function)==null?void 0:P.arguments)!=null?z:""),g.enqueue({type:"tool-input-delta",id:C.id,delta:(Z=k.function.arguments)!=null?Z:""}),((ne=C.function)==null?void 0:ne.name)!=null&&((J=C.function)==null?void 0:J.arguments)!=null&&ge(C.function.arguments)&&(g.enqueue({type:"tool-call",toolCallId:(x=C.id)!=null?x:U(),toolName:C.function.name,input:C.function.arguments,providerMetadata:{openrouter:{reasoning_details:h}}}),C.sent=!0)}if(q.images!=null)for(const k of q.images)g.enqueue({type:"file",mediaType:Ce(k.image_url.url,"image/jpeg"),data:be(k.image_url.url)})},flush(S){var g;if(l==="tool-calls")for(const I of i)I&&!I.sent&&(S.enqueue({type:"tool-call",toolCallId:(g=I.id)!=null?g:U(),toolName:I.function.name,input:ge(I.function.arguments)?I.function.arguments:"{}",providerMetadata:{openrouter:{reasoning_details:h}}}),I.sent=!0);b&&S.enqueue({type:"reasoning-end",id:a||U()}),_&&S.enqueue({type:"text-end",id:m||U()});const E={usage:f};O!==void 0&&(E.provider=O),h.length>0&&(E.reasoning_details=h),S.enqueue({type:"finish",finishReason:l,usage:d,providerMetadata:{openrouter:E}})}})),warnings:[],request:{body:s},response:{headers:p}}}};function An({prompt:e,inputFormat:t,user:n="user",assistant:o="assistant"}){if(e.length===1&&e[0]&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0]&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0]&&e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:r,content:p}of e)switch(r){case"system":throw new Lt({message:`Unexpected system message in prompt: ${p}`,prompt:e});case"user":{const i=p.map(l=>{switch(l.type){case"text":return l.text;case"file":throw new W({functionality:"file attachments"});default:return""}}).join("");s+=`${n}:
${i}

`;break}case"assistant":{const i=p.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new W({functionality:"tool-call messages"});case"tool-result":throw new W({functionality:"tool-result messages"});case"reasoning":throw new W({functionality:"reasoning messages"});case"file":throw new W({functionality:"file attachments"});default:return""}}).join("");s+=`${o}:
${i}

`;break}case"tool":throw new W({functionality:"tool messages"})}return s+=`${o}:
`,{prompt:s}}var $e=B([u({id:c().optional(),model:c().optional(),choices:$(u({text:c(),reasoning:c().nullish().optional(),reasoning_details:Te.nullish(),finish_reason:c().nullish(),index:y().nullish(),logprobs:u({tokens:$(c()),token_logprobs:$(y()),top_logprobs:$(Et(c(),y())).nullable()}).passthrough().nullable().optional()}).passthrough()),usage:u({prompt_tokens:y(),prompt_tokens_details:u({cached_tokens:y()}).passthrough().nullish(),completion_tokens:y(),completion_tokens_details:u({reasoning_tokens:y()}).passthrough().nullish(),total_tokens:y(),cost:y().optional(),cost_details:u({upstream_inference_cost:y().nullish()}).passthrough().nullish()}).passthrough().nullish()}).passthrough(),de]),Ot=class{constructor(e,t,n){this.specificationVersion="v2",this.provider="openrouter",this.supportedUrls={"image/*":[/^data:image\/[a-zA-Z]+;base64,/,/^https?:\/\/.+\.(jpg|jpeg|png|gif|webp)$/i],"text/*":[/^data:text\//,/^https?:\/\/.+$/],"application/*":[/^data:application\//,/^https?:\/\/.+$/]},this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}getArgs({prompt:e,maxOutputTokens:t,temperature:n,topP:o,frequencyPenalty:s,presencePenalty:r,seed:p,responseFormat:i,topK:l,stopSequences:d,tools:f,toolChoice:h}){const{prompt:_}=An({prompt:e,inputFormat:"prompt"});if(f?.length)throw new W({functionality:"tools"});if(h)throw new W({functionality:"toolChoice"});return T(T({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:t,temperature:n,top_p:o,frequency_penalty:s,presence_penalty:r,seed:p,stop:d,response_format:i,top_k:l,prompt:_,include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning},this.config.extraBody),this.settings.extraBody)}async doGenerate(e){var t,n,o,s,r,p,i,l,d,f,h,_,b,m,a;const O=(e.providerOptions||{}).openrouter||{},S=T(T({},this.getArgs(e)),O),{value:g,responseHeaders:E}=await le({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:ie(this.config.headers(),e.headers),body:S,failedResponseHandler:ue,successfulResponseHandler:bt($e),abortSignal:e.abortSignal,fetch:this.config.fetch});if("error"in g){const j=g.error;throw new V({message:j.message,url:this.config.url({path:"/completions",modelId:this.modelId}),requestBodyValues:S,statusCode:200,responseHeaders:E,data:j})}const I=g.choices[0];if(!I)throw new ut({message:"No choice in OpenRouter completion response"});return{content:[{type:"text",text:(t=I.text)!=null?t:""}],finishReason:ce(I.finish_reason),usage:{inputTokens:(o=(n=g.usage)==null?void 0:n.prompt_tokens)!=null?o:0,outputTokens:(r=(s=g.usage)==null?void 0:s.completion_tokens)!=null?r:0,totalTokens:((i=(p=g.usage)==null?void 0:p.prompt_tokens)!=null?i:0)+((d=(l=g.usage)==null?void 0:l.completion_tokens)!=null?d:0),reasoningTokens:(_=(h=(f=g.usage)==null?void 0:f.completion_tokens_details)==null?void 0:h.reasoning_tokens)!=null?_:0,cachedInputTokens:(a=(m=(b=g.usage)==null?void 0:b.prompt_tokens_details)==null?void 0:m.cached_tokens)!=null?a:0},warnings:[],response:{headers:E}}}async doStream(e){const n=(e.providerOptions||{}).openrouter||{},o=T(T({},this.getArgs(e)),n),{value:s,responseHeaders:r}=await le({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:ie(this.config.headers(),e.headers),body:Y(T({},o),{stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0}),failedResponseHandler:ue,successfulResponseHandler:yt($e),abortSignal:e.abortSignal,fetch:this.config.fetch});let p="other";const i={inputTokens:Number.NaN,outputTokens:Number.NaN,totalTokens:Number.NaN,reasoningTokens:Number.NaN,cachedInputTokens:Number.NaN},l={};return{stream:s.pipeThrough(new TransformStream({transform(d,f){var h,_,b;if(!d.success){p="error",f.enqueue({type:"error",error:d.error});return}const m=d.value;if("error"in m){p="error",f.enqueue({type:"error",error:m.error});return}if(m.usage!=null){if(i.inputTokens=m.usage.prompt_tokens,i.outputTokens=m.usage.completion_tokens,i.totalTokens=m.usage.prompt_tokens+m.usage.completion_tokens,l.promptTokens=m.usage.prompt_tokens,m.usage.prompt_tokens_details){const O=(h=m.usage.prompt_tokens_details.cached_tokens)!=null?h:0;i.cachedInputTokens=O,l.promptTokensDetails={cachedTokens:O}}if(l.completionTokens=m.usage.completion_tokens,m.usage.completion_tokens_details){const O=(_=m.usage.completion_tokens_details.reasoning_tokens)!=null?_:0;i.reasoningTokens=O,l.completionTokensDetails={reasoningTokens:O}}l.cost=m.usage.cost,l.totalTokens=m.usage.total_tokens;const v=(b=m.usage.cost_details)==null?void 0:b.upstream_inference_cost;v!=null&&(l.costDetails={upstreamInferenceCost:v})}const a=m.choices[0];a?.finish_reason!=null&&(p=ce(a.finish_reason)),a?.text!=null&&f.enqueue({type:"text-delta",delta:a.text,id:U()})},flush(d){d.enqueue({type:"finish",finishReason:p,usage:i,providerMetadata:{openrouter:{usage:l}}})}})),response:{headers:r}}}},Un=class{constructor(e={}){var t,n;this.baseURL=(n=kt((t=e.baseURL)!=null?t:e.baseUrl))!=null?n:"https://openrouter.ai/api/v1",this.apiKey=e.apiKey,this.headers=e.headers}get baseConfig(){return{baseURL:this.baseURL,headers:()=>T({Authorization:`Bearer ${mt({apiKey:this.apiKey,environmentVariableName:"OPENROUTER_API_KEY",description:"OpenRouter"})}`},this.headers)}}chat(e,t={}){return new It(e,t,Y(T({provider:"openrouter.chat"},this.baseConfig),{compatibility:"strict",url:({path:n})=>`${this.baseURL}${n}`}))}completion(e,t={}){return new Ot(e,t,Y(T({provider:"openrouter.completion"},this.baseConfig),{compatibility:"strict",url:({path:n})=>`${this.baseURL}${n}`}))}};function Nn(e){return Object.fromEntries(Object.entries(e).filter(([,t])=>t!==null))}function Pn(e,...t){const n=Nn(e??{}),s=[n["user-agent"]||"",...t].filter(Boolean).join(" ");return Y(T({},n),{"user-agent":s})}var Dn="1.3.0";function qn(e={}){var t,n,o;const s=(n=kt((t=e.baseURL)!=null?t:e.baseUrl))!=null?n:"https://openrouter.ai/api/v1",r=(o=e.compatibility)!=null?o:"compatible",p=()=>Pn(T({Authorization:`Bearer ${mt({apiKey:e.apiKey,environmentVariableName:"OPENROUTER_API_KEY",description:"OpenRouter"})}`},e.headers),`ai-sdk/openrouter/${Dn}`),i=(h,_={})=>new It(h,_,{provider:"openrouter.chat",url:({path:b})=>`${s}${b}`,headers:p,compatibility:r,fetch:e.fetch,extraBody:e.extraBody}),l=(h,_={})=>new Ot(h,_,{provider:"openrouter.completion",url:({path:b})=>`${s}${b}`,headers:p,compatibility:r,fetch:e.fetch,extraBody:e.extraBody}),d=(h,_)=>{if(new.target)throw new Error("The OpenRouter model function cannot be called with the new keyword.");return h==="openai/gpt-3.5-turbo-instruct"?l(h,_):i(h,_)},f=(h,_)=>d(h,_);return f.languageModel=d,f.chat=i,f.completion=l,f}var Vn=qn({compatibility:"strict"});export{Un as OpenRouter,qn as createOpenRouter,Vn as openrouter};
//# sourceMappingURL=index-CoNnFxUU.js.map
